<!DOCTYPE HTML>

<html>

<head>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
            integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
            crossorigin=""></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>
<title>CLICK HANDLER</title>
    <div id="map" style="height: 400px;"></div>
<script>

        function init()
        {

                // Initialize the map and set its view
                var map = L.map('map').setView([31.0461, 34.8516], 8);

                // Add the tile layer from OpenStreetMap
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
                    maxZoom: 18,
                }).addTo(map);

                // display saved location value
                var locationValue = '[{"lat": 30.12345, "lng": 40.67890}, {"lat": 31.23456, "lng": 41.78901}, {"lat": 32.34567, "lng": 42.89012}, {"lat": 33.45678, "lng": 43.90123}]';
                if(locationValue && locationValue != "None"){
                    var jsonString = locationValue.replace(/&quot;/g, '"');
                    var parsedData = JSON.parse(jsonString);

                    var openStreetMapCoordinates = parsedData.map(function(obj) {
                        return [obj.lat, obj.lng];
                    });

                    var drawnItems = new L.FeatureGroup();
                    map.addLayer(drawnItems);
                    if(openStreetMapCoordinates.length == 5){
                    var polygon = L.polygon(openStreetMapCoordinates).addTo(map);
                    map.fitBounds(polygon.getBounds());
                    }
                    if(openStreetMapCoordinates.length == 4){
                    var rectangle = L.rectangle(openStreetMapCoordinates).addTo(map);
                    map.fitBounds(rectangle.getBounds());
                    }
                }
                var locationValue = '{"lat": 31.78901, "lng": 41.83456}';
                if(locationValue && locationValue != "None"){
                    var jsonString = locationValue.replace(/&quot;/g, '"');
                    console.log("jsonString  -  ", jsonString);
                    var parsedData = JSON.parse(jsonString);
                    console.log("parsedData  -  ", parsedData);
                    var marker = L.marker(parsedData).addTo(map);

                }


}


</script>


<body onload='init();'>
<div id="Map" style="height: 650px"></div>

</body>

</html>

